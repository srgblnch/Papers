%\documentclass[a4paper,10pt]{article}
\documentclass[10pt,a4paper,twoside]{llncs}
%\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{amsmath,amsfonts,amssymb}%\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{graphicx}
\usepackage{algorithmic,algorithm}
\usepackage{tikz}
\usetikzlibrary{matrix}

\pagestyle{headings}%page numbers

%%%%%%%%%%%%%%%%%%%%%%%%%%% VERSIONES %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{gitinfo}
\newcommand{\version}{github.Papers: \gitCommitterDate\;(revision \gitAbbrevHash) }
\newcommand{\todo}[1]{\texttt{\color{red}TODO:} ``\emph{#1}''}
\newcommand{\fixme}[1]{\texttt{\color{red}FIXME:} ``\emph{#1}''}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%opening
\title{Security risk associated with multiple users sharing the same elliptic curve}
\author{Sergi Blanch-Torn\'e\inst{1}, Ramiro Moreno Chiral\inst{2}, Francesc Seb\'e Feixa\inst{2}}
 \institute{
 Escola Polit\`ecnica Superior, Universitat de Lleida. Spain.\\
 \email{\tt sblanch@alumnes.udl.es}
 \and 
 Departament de Matem\`atica. Universitat de Lleida. Spain.\\
 \email{\tt \{ramiro,fsebe\}@matematica.udl.es}
 }

%%% Definiciones matem\'aticas especiales

\newcommand{\Z}{\ensuremath{\mathbb{Z}}}%                       Enteros
\newcommand{\Q}{\ensuremath{\mathbb{Q}}}%                       Racionales
\newcommand{\A}{\ensuremath{\mathcal{A}_{2}}}%                   Plano Af\'{\i}n
\newcommand{\Proy}{\ensuremath{\mathcal{P}_{2}}}%                Plano Proyectivo
\newcommand{\Jacob}{\ensuremath{\mathcal{J}_{2}}}%               Plano Jacobiano
\newcommand{\K}{\ensuremath{\mathbb{K}}}%                       Cuerpo en general
\newcommand{\F}{\ensuremath{\mathbb{F}}}%                       Cuerpo finito en general
\newcommand{\Fp}{\ensuremath{\mathbb{F}_p}}%                    Cuerpo finito de orden p (primo)
\newcommand{\EFp}{\ensuremath{E(\mathbb{F}_p)}}%                Curva el\'\{i}ptica sobre un cuerpo finito de orden p (primo)
\newcommand{\EFq}{\ensuremath{E(\mathbb{F}_q)}}%                Curva el\'\{i}ptica sobre un cuerpo finito
\newcommand{\Fm}{\ensuremath{\mathbb{F}_{2^m}}}%                Cuerpo finito de caractar\'{\i}stica 2, grado m
\newcommand{\EFm}{\ensuremath{E(\mathbb{F}_p)}}%                Curva el\'\{i}ptica sobre un cuerpo finito de caractar\'{\i}stica 2, grado m
\newcommand{\Fq}{\ensuremath{\mathbb{F}_q}}%                    Idem id. q (q=p^m, p primo y m entero pos.)
\newcommand{\Zn}[1]{\ensuremath{\mathbb{Z}/#1\mathbb{Z}}}%      Anillo de los enteros mod n
\newcommand{\PaI}{\ensuremath{\mathcal{O}}}%                    Punto en el Infinito
\newcommand{\PaIe}{\ensuremath{\mathcal{O}_{E}}}%               Punto en el Infinito de la curva

%%% Algorithm customization:
%\floatname{algorithm}{Procedure}%Rename the text ``Algorithm''
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}
%%% end algorithm

\begin{document}

\maketitle
\begin{center}
 \today\\
 \version
\end{center}


\begin{abstract}\footnote{Partially supported by grants MTM2010-21580-C02-01 (Spanish Ministerio de Ciencia e Innovaci\'on), 2009SGR-442 (Generalitat de Catalunya).}
\fixme{this probably is too long}
One of the main good features of the elliptic curves is the possibility to change the group where the cryptography is based, without a penalty in the length of this group. Using a different elliptic curve the cyclic subgroup is completely different and the cryptanalysis that someone can have done over one curve is useless over another curve over the same finite field size. The complexity to port an attack from one curve to another can be even bigger than restart the attack over the second one from scratch.

Also as is said in section 5.1 of \cite{X9.62-1998}, the security in elliptic curves doesn't rely on the secrecy of the domain parameters, the risk is when multiple users shares the same elliptic curve parameters. The current standardization \cite{rfc6637} flow goes in the way to have one curve per length and three possible lengths. That means more than multiple users with the same domain parameters, that means almost all the users with the same domain parameters.

It is a request of this standard to find a way to add randomization between the used elliptic curves and in this paper two ways will be explored. Both likes to get an ``auditable'' algorithm to the final user to get its particular elliptic curve. The difference between this two ways is if the algorithm starts from scratch of from one cryptographically good curve.
\\\\    
{\bf Keywords:} Cryptography, Elliptic Curves, Isogeny
\end{abstract}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction \label{sec:intro}}
%% Justify the need of the curve randomization

The introduction of the elliptic curves in the standards are following its path, and it is having a good health. Even that the \cite{rfc4880} does not include the elliptic curve cryptosystem in the same level than the finite fields, the ECDSA is already standardized (\cite{NIST186-3} and \cite{rfc5832}) and many implementations are available, the encryption has been released last year after a long process \cite{rfc6637}. But this standard is restricting the number of curves to three (NIST curves from the \cite{NIST186-3} P-256, P-384, P-521). In the best case this future standard allows the usage of curves with an assigned OID from the IANA, for example the \cite{brainpool} standardized or the \cite{sec2}. Even if the list can be very extended with this OIDs, there are more than hundredths thousands good elliptic curves excluded with this method.

This OID method can be an option for keys where the bandwidth is limited, but there must be the possibility to use any good curve, because is one of the best advantages of the elliptic curve cryptography.

\todo{needs to tell shortly about how the next sections are structured}

Apart from this issue of the curve limitation, the refereed standard for elliptic curve encryption have many other good aspects. This standard propose an schema that is similar to the ones proposed in \cite{BM06} with the collaboration of Mikael Mylnikov, developed independently to the standard proposed, but we arrive to the same conclusions. The schema of ElGamal cannot be translated from finite fields to elliptic curves without modification.

Next some general concepts about fields \K, or algebraic rings $(R,+,\cdot)$ or \Zn[n], or more particularly finite fields \Fq will be used and needs to be introduced.

\begin{definition}\label{def:cf}
 A finite field of $q$ order, \Fq \;factorizes necessarily like $q=p^r$ where $p$ is a characteristic prime of the field and $r \in \mathbb{Z}_{>0}$ the extension degree.
\end{definition}

In case of a small $p$, the extension is big like happens with the primes $2$ or $3$. This way vectorial spaces are defined like the finite fields of characteristic $2$ denoted as \Fm. In another case, when $p$ is big, the extension is small (usually $r=0$ and prime finite fields are defined denoted as \Fp.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{What is an elliptic curve? \label{sec:ce}}

%% elliptic curve formal definition and equations

\begin{definition}\label{def:ce}
An Elliptic curve is \emph{nonsingular} curve of genus $1$ over a field $\mathbb{K}$, with at least one $K$-rational point denoted $E/\mathbb{K}$, given by the Weierstra\ss{} normal form equation (in an Affine plane \A):
\begin{equation}\label{eq:WNF}
E/\mathbb{K}:\; y^{2} + a_{1}xy + a_{3}y = x^{3} + a_{2}x^{2} + a_{4}x + a_{6},\; a_{i} \in \mathbb{K}
\end{equation}
\end{definition}

An elliptic curve can be defined over any field, like real numbers $\mathbb{R}$ where representations over coordinate axis are more human-readable, but in cryptology usually are defined over finite fields.

A singular point is when both partial derivatives vanish, in $\mathbb{R}$ representation means that the curve never has beaks neither nodes. Analytically can be differentiate by the \emph{discriminant} (represented with $\Delta$) that must \emph{not} be 0 in the \emph{nonsingular} curves.

When the curve is defined over a prime finite field, the Weierstra\ss{} equation can be written in the normal reduced affine form:
\begin{equation}\label{eq:WRF}
y^2=x^3+ax+b
\end{equation}

And the \emph{elliptic curve discriminant} over the prime finite field also can be described using the indexes $a$ and $b$ from the equation \ref{eq:WRF} as $\Delta = -16(4a^3+27b^2)\ne 0$.

%% define the cardinality of an elliptic curve, (the order and the cofactor def in the nonsupersingularity)
Another important parameter of an elliptic curve is the cardinality, who can be defined as:
\begin{definition}\label{def:cardinality}
 The \emph{cardinality} of an elliptic curves $E$ over \Fq is defined as the number of \Fq-rational points. Where a \Fq-rational points is a pair $(x,y)\in \mathbb{F}_{q}^{2}$ such that follows the elliptic curve equation.
\end{definition}
\fixme{this definition here is a bit forced, but where is this better?}

%% Introduce the PaI
A curve over a general finite field $\mathbb{F}$ is composed by the points of the curve with the notation $E\left(\mathbb{F}\right)$. The points of an elliptic curve over a prime finite field are all ones that resolves the equation \ref{eq:WRF} union the point at infinity (the neutral element of the group, denoted \PaI) who does not have representation over the affine plane and other coordinate representations are better like the projectives \Proy $\;$ or Jacobians \Jacob.

%% affine coordinates
\begin{definition}\label{def:afinproy}
 There are an application between the points in the afine plane $\mathcal{A}_{2}\left(\mathbb{F}\right)$ and the projective plane $\mathcal{P}_{2}\left(\mathbb{F}\right)$ and this correspondence is reciprocal:
\begin{equation}
        \begin{array}{cccc}
        f: & \mathcal{A}_{2}\left(\mathbb{F}\right) & \rightarrow & \mathcal{P}_{2}\left(\mathbb{F}\right) \\
        \; & (x,y)                                 & \mapsto     & [x:y:1] \\
        \end{array}
\end{equation}
\begin{equation}
        \begin{array}{cccc}
        f^{-1}: & \mathcal{P}_{2}\left(\mathbb{F}\right) & \rightarrow & \mathcal{A}_{2}\left(\mathbb{F}\right) \\
        \;      & \left[X:Y:Z\right]                    & \mapsto     & \left\{ \begin{array}{ccc}
                                                                                \left(\frac{X}{Z},\frac{Y}{Z}\right) & \text{if} & Z\neq0\\
                                                                                \neg\exists & \text{if} & Z=0
                                                                                \end{array}
                                                                        \right. \\
        \end{array}
\end{equation}
There exist a equivalence relation between points in the projective plane following:
\begin{equation}
        \begin{array}{c}
                \left(x,y,z\right) \sim \left(x',y',z'\right) \Rightarrow \exists\lambda \in \mathbb{F}^{*} \\
                 x=\lambda x', y=\lambda y',z=\lambda z' | x,y,z \in \mathbb{F}
        \end{array}
\end{equation}
\end{definition}

%% Projective coordinates
In the projective plane, three coordinates are used to represent a two-dimensional point, knowing $x=\frac{X}{Z}$ and $y=\frac{Y}{Z}$ the Weierstra\ss{} reduced normal form \ref{eq:WRF} will be $\frac{Y^{2}}{Z^{2}} = \frac{X^{3}}{Z^{3}} + a\frac{X}{Z} + b$, simplified:
\begin{equation}\label{eq:WRFProy}
        Y^{2}Z = X^{3} + aXZ^{2} + bX^{3}
\end{equation}

\fixme{??jacobian coordinates: Have they enough interest for the objective of this article?}

Over a Jacobian plane, also three coordinate are used to represent the points, knowing $x=\frac{X}{Z^2}$ and $y=\frac{Y}{Z^3}$ the Weierstra\ss{} reduced normal form \ref{eq:WRF} is:
\begin{equation}\label{eq:WRFJacobian}
        Y^{2}Z = X^{3} + aXZ^{4} + bX^{6}
\end{equation}

As is described in \cite{EC&NT&crypt} the projective coordinates improves the operation of the point addition, but the jacobian coordinates gives an advantage over the doubling point operation.

\todo{the lost transforming from one representation to the other is worst than use only one? Are they equally good or bad because the distribution of of 0's an 1's are similar?}

An the joint of points of an elliptic curve over a prime finite field, described in projective coordinates is:
\begin{equation}\label{eq:conjEK}
E\left(\mathbb{F}_{p}\right) = \left\{ Y^{2}Z = X^{3} + aXZ^{2} + bZ^{3} \bigcup \PaIe \right\} \\
\end{equation}
Simplifying the definition \ref{def:cardinality}, the cardinality of an elliptic curve defined over \Fq is the number of elements in the joint of points of this curve. The cardinality is denoted as $|$\EFq$|$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Operation between points of an elliptic curve \label{sec:ce_ops}}

%% Bijective application

With the set of points of an elliptic curve defined in \ref{eq:conjEK} a bijective application can be defined between two points and a third one, of the same set, even if they are points of the elliptic curve or the point at infinity \PaIe.

\begin{equation}\label{eq:eccAdd}
        \begin{array}{cccc}
                \emph{\text{+}}: & E\left(\mathbb{F}_{p}\right) & \rightarrow & E\left(\mathbb{F}_{p}\right) \\
                \;     & P+Q                           & \mapsto     & R \\
        \end{array}
\end{equation}

This application, that will be called \emph{addition}, has an algebraic structure of an \emph{Abelian group} because satisfies some requirements: Closure in the group, associativity, identity element, inverse element, and commutativity.

\begin{definition}\label{def:eccEscProd}
Given this addition operation applied to a point together with itself, this point is \emph{duplicated}; this addition with itself can be done many times and define it as the \emph{scalar product} where the scalar represents the number of times the point is added to itself:
\begin{equation}\label{eq:eccEscProd}
        \begin{array}{cccc}
                \emph{\text{*}}: & E\left(\mathbb{F}_{p}\right) & \rightarrow & E\left(\mathbb{F}_{p}\right) \\
                \;     & \underbrace{P+\cdots+P}_{x}                & \mapsto     & Q=x * P \\
        \end{array}
\end{equation}
\end{definition}

The common notation for this operation is $Q = [x ] P$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Characteristics cryptographically good elliptic curves \label{sec:good_ce}}

As Koblitz proposes \cite{Koblitz87ecc} an elliptic curve defined over finite fields can be used in cryptology. But to be a cryptographically good elliptic curve when it is defined over a finite field like the ones described in \ref{def:ce}, but it needs a bit more to avoid curves susceptible of known attacks. There are some characteristics to be checked.

%% hasse interval

\begin{definition}\label{def:Hasse}
 Given an elliptic curve with enough point, it must have a cardinality in the \emph{Hasse interval}:
\begin{equation}\label{eq:hasse}
| \EFq | \in \left( q+1-2\sqrt{q} , q+1+2\sqrt{q} \right)
\end{equation}
\end{definition}

%% nonsupersingular elliptic curve

In the elliptic curve definition \ref{def:ce} it requires that the curve does not have any singularity, but to use an elliptic curve in cryptography the curve not only has to be \emph{nonsingular}, the curve can not be \emph{supersingular}.

\begin{definition}\label{def:nonsupersing}
 An elliptic curve is \emph{not} supersingular when the cardinal is \emph{almost}-primer. And this almost-primarity is when, if the cardinality can be decomposed it must has a prime divisor sufficiently big.
\end{definition}

Following the notation of the \cite{P1363} a almost-prime cardinal of an elliptic curve have, at most, two factors:
\begin{equation}\label{amostprime}
| \EFq | = h \cdot n
\end{equation}
Where the $h$ is called cofactor and is much more smaller than $n$ ($h \lll n$) and both are prime. Also can be said that the cardinal is \emph{almost} the primer $n$ ($|\EFq| \approx n$). In fact, in the refereed standard (\cite{P1363}) is not recomended to use other cofactors that $1$ or $2$ or, in the biggest case $4$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Cyclic subgroup to define a Discrete Logarithm Problem \label{sec:ecdlp}}

%% What a cyclic subgroup is and means
From the joint of points of a cryptographically good elliptic curve is necessary to distinguish a subset of points who are part of a cyclic group of an sufficiently big order. A generator point must be founded $G \in \EFp$, who is a point capable to produce:
\begin{equation}\label{eq:sgc}
\left\langle G\right\rangle = \left\{ G,2G,3G,\dots,nG=\mathcal{O}\right\} \; \vert \; \text{ord}(G) = n
\end{equation}

%% define the cryptosystem setup (tuple)
\begin{corollary}
The elements defined for the elliptic curve cryptosystem can be described in a tuple structure. First of all the curve is defined over a primer finite field \Fp, the curve can be described with the parameters $a$ and $b$ following the equation \ref{eq:WRF}. In this set of points there is a generator $G$ with order $n$ and a cofactor $h$. All of them can be resumed in a sextuple:
\begin{equation}\label{eq:setupla}\left\{ p,a,b,G,n,h\right\}\end{equation}
\end{corollary}

This set of parameters is what describes de \emph{cryptosystem setup} and the operation computationally hard over we define the cryptography is with in the cyclic subgroup mention before. The \emph{discrete logarithm problem} can be defined over elliptic curves as how to solve the number of times that a point must be added with it self to have the other as a result, following the definition \ref{def:eccEscProd}:
\begin{equation}\label{ECDLP}
        \begin{array}{cccc}
                \emph{ECDLP}: & \left\langle G\right\rangle & \rightarrow & \mathbb{Z} \\
                \;     & Q=[x]P                           & \mapsto     & x  \\
        \end{array}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Get an elliptic curve from scratch \label{sec:scratch}}

Generate an elliptic curve is not a hard job, what is hard is to generate an cryptographically good elliptic curve who satisfies the cryptosystem requirements. And also do this in a computationally reasonable time, for all the current possible lengths of the finite field. This procedure must be run in the execution time of the user key generation, and we must assume than this machines will be non very powerful, perhaps an embedded system or an smart card.

% Base algorithm of key generation
% 1. generar un a i b
% 2. calcular el discriminant (pq no sigui singular)
% 3. calcular el cardinal (using SEA algorithm)
% 4. factoritzar-lo per saber l'ordre i el cofactor

\begin{algorithm}
\caption{Generate a cryptographically good elliptic curve}\label{alg:scratch}
\begin{algorithmic}[1]
\REQUIRE Prime $p$ how defines \Fp.
\ENSURE Struct with cryptosystem parameters (see \ref{eq:setupla})
\REPEAT
\STATE Generate $a$ and $b$ $\in_{R}$\Fp
\STATE Check non zero discriminant $\Delta$
\STATE Calculate the cardinal $\left| E\left(\mathbb{F}_{p}\right)\right|$ %?usign SEA
\STATE Check the cardinal is in between the Hasse interval
\STATE Get the cardinal factors $n,h$ or go to step 1
\UNTIL{$h \in \left[1,2,4\right]$}
\STATE Return $\{p,a,b,n,h\}$;
\end{algorithmic}
\end{algorithm}%

This algorithm does not returns a generator who is also a cryptosystems parameter, because its algorithm to found it is not part of this article has been excluded in this algorithm. This algorithm also sets a restriction than cofactor must be $1$, $2$ or $4$, who comes from the P1363 rules (\cite{P1363}). The cofactor size affects on the group of points of the cyclic subgroup where the cryptography will be.

\todo{with the SEA algorithm, the citation of the article is need}
The steps of the algorithm \ref{alg:scratch} can be performed in many ways to try to reduce the execution time. The cardinal calculation can be using the \emph{SEA} algorithm  and the \emph{Hasse interval} (definition \ref{def:Hasse}) check can be optimized to avoid unnecessary operation, but in a final implementation all this code must be written aware of the side channel attacks. The factorization of the cardinal allows the possibility to only tries to find a little cofactor and check the primary on the $n$ candidate.

\todo{This must have some computational results}

\todo{Approach to the number of good curves instead of the number of possible curves in a list. get it form a huge list (can be OIDs) excludes too much curves, and I cannot be sure from where they come from (extreme paranoia, try to dress this)}
\cite{DAS_guide}% sec 4.7: how many elliptic curves

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Find a good elliptic curve from another good one \label{sec:from_another}}
%% knowing one good curve, is there any way to transform it to another one who still have the good properties, without the issues of the first, and without a portable cryptanalysis?

Another method than get a curve from scratch of section \ref{sec:scratch} is to find a cryptographically good curve based on another curve using a procedure who maintains the good skills and protect the new one from the bad ones as much as possible. The main objective is to avoid the portability of the cryptanalysis from the first curve to the new one, without create any other weakness in the procedure or the new one it self.

%% can the isogeny stars (or volcanoes) be a way to do this?
One proposed way to have this requirements are the elliptic curve isogenies. The isogenies have the good skill that they maintain the cardinal from one curve to another, as it will be describe next. And about the main objective to block any type of portability of the cryptanalysis from one curve to another seems to be ok, because this transformation is a hard problem on isogenies.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{What is elliptic curve isogeny? \label{sec:isog}}

The concept of \emph{isogeny} describes a particular case of an \emph{isomorphism}, the first thing to be formally defined is the isomorphism.

\begin{definition}\label{def:isomorphism}
 Given two elliptic curves $E/\mathbb{K}$ and $E'/\mathbb{K}$ with an equations in the Weierstra\ss{} Normal Form described in \ref{eq:WNF}, an isomorphism over the field is when exist $u,r,s,t\in\mathbb{K}$ with $u\neq0$, such a variable change:
\begin{equation}\label{eq:isomorphisminWNF}
 (x,y) \rightarrow (u^2x+r,u^3y+u^2sx+t)
\end{equation}
In case that the curves have the equation in the Weierstra\ss{} Reduced Form describer in \ref{eq:WRF}, the variable change is simplified being:
\begin{equation}\label{eq:isomorphisminWRF}
 (x,y) \rightarrow (u^2x,u^3y)
\end{equation}
\end{definition}

The relation of isomorphism is an equivalence relation in a set of the elliptic curves, defined over the same field, where all the curves in the class have the set of $\mathbb{K}$-rational points isomorphic also. Remember from the definition \ref{def:cardinality}, the $\mathbb{K}$-rational points defines the \emph{cardinality} of the elliptic curve, then when two curves are isomorphic, they have the same cardinality.

As has been say at the beginning of this section, the isogenies are a particular case of isomorphisms.

\begin{definition}\label{def:isogeny}
 Given two elliptic curves $E/\mathbb{K}$ and $E'/\mathbb{K}$, they are \emph{isogenies over $\mathbb{K}$} \emph{iff} exist an isomorphism with coefficients in the field $\mathbb{K}$ (exist a map between all the points of the initial elliptic curve $E$ to the final elliptic curve $E'$) where the neutral element of the elliptic curve $E/\mathbb{K}$ is mapped to the neutral element of the elliptic curve $E'/\mathbb{K}$.

\begin{equation}\label{eq:isogenia}
        \begin{array}{cccc}
                \mathcal{I}: & E/\mathbb{K} & \rightarrow & E'/\mathbb{K} \\
                \;           & (x,y)        & \mapsto     & (X,Y) \\
                \;           & \mathcal{O}_{E} & \mapsto  & \mathcal{O}_{E'} \\
        \end{array}
\end{equation}

Where $X$ and $Y$ responds to $X=f_{1}(x)$ and $Y=f_{2}(x,y)$. As $f_{1}$ like $f_{2}$ are functions $\mathbb{K}$-rational.
\end{definition}

An isogeny $\mathcal{I}$ is an exhaustive application. Except in the case that the isogeny is like $\mathcal{I}(E)=\{\mathcal{O}\}$, when is said as constant, then exist a unique isogeny: $\widehat{\mathcal{I}}:E' \rightarrow E$ called the \emph{dual isogeny}.

\fixme{Modular equation (symmetric polynomial of degree $\ell+1$)?}

From this definition \ref{def:isogeny} must be extracted that the cardinality of the elliptic curve is maintained, and they have the same value for both curves. Also is important to remark that the neutral element is constant in the transformation:
 \begin{equation}\label{eq:isoPaI}
        \mathcal{I}\left(\PaIe\right) = \mathcal{O}_{E'}
\end{equation}

And, finally, remark that for all point $P \in E/\mathbb{K}$ exist a $P' \in E'/\mathbb{K}$. Where can be assumed for the generator $G \in E/\mathbb{K}$ exist a $G' \in E'/\mathbb{K}$ and for the public key $P=[d]G \in E/\mathbb{K}$ exist a $P'=[d']G' \in E'/\mathbb{K}$ with the same secret key, because of $\mathcal{I}\left(P+Q\right) = \mathcal{I}\left(P\right)+\mathcal{I}\left(Q\right)$.

\todo{Given two elliptic curves $E/\mathbb{K}$ and $E'/\mathbb{K}$, with an isogeny application $\mathcal{I}: E/\mathbb{K} \rightarrow E'/\mathbb{K}$, the cyclic subgroup generator $G \in E/\mathbb{K}$ can be \emph{translated} into $E'/\mathbb{K}$ as $G'=\mathcal{I}\left(G\right)$.\\ The same way the public key $P \in E/\mathbb{K}$ becomes $P'=\mathcal{I}\left(P\right)$. But what about the secret key $d$? If it's preserved as the same value, the transformation is simply an automorphism, isn't it?}

\todo{$P=[d]G \in E/\mathbb{K}$ and $\mathcal{I}: E/\mathbb{K} \rightarrow E'/\mathbb{K}$ and  $P'=\mathcal{I}\left(P\right)=\mathcal{I}\left([d]G\right)=[d']\mathcal{I}\left(G\right)=[d']G'$ then how to \emph{migrate} $d$ to $d'$ from one curve to another?}

\fixme{isogeny degree, composition of isogenies (prime degree)}

\begin{definition}\label{def:iso_degree}
 Given two isogenic elliptic curves $E/\mathbb{K}$ and $E'/\mathbb{K}$, the degree of the isogeny between this two curves is the degree of the rational map between them.
\end{definition}
%% With this I understand that a low degree isogenies have a small map, then not many points mapped (but not easy to distinguish the if a point has been mapped?). Then the biggest order of this degree is the cardinal? What about the field extensions?

For all the isogenies with a degree greater than 1, they can be factored into a composition of isogenies of a prime degree over the base finite field \Fq.

\todo{isogeny cases: Ascending, descending, horizontal}

\todo{Isogeny class}
\begin{definition}\label{def_iso_class}
 Given an elliptic curve $E/\mathbb{K}$ an endomorphism class or isogeny class of degree $\ell$ is the set of elliptic curves... 
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Volcano, volcanoes ranges and starts \label{sec:volcano}}

\fixme{define a volcano: as a graph of isogenies of a particular degree.}

To describe the structure of the $\ell$ degree isogeny class it has been proposed a graph. Using the different cases of isogenies in the same isogeny class two main parts of the graph can be described. There is a part of the graph that is cyclic, and from each node an edge goes down with a balanced $\ell$-tree. All the nodes in the circumference have each tree with the same altitude. The number of edges of each node is $(\ell+1)$

% volcano graph
% modification based on: http://hal.archives-ouvertes.fr/docs/00/63/28/41/TEX/VersionJournal.tex
\begin{figure}
\begin{center}
\begin{pgfpicture}{-3cm}{1cm}{13cm}{4cm}
%setup the graph frame
\pgfsetxvec{\pgfpoint{0.6cm}{0cm}}
\pgfsetyvec{\pgfpoint{0cm}{0.4cm}}
% draw the crater as an ellipse
\pgfellipse[stroke]{\pgfxy(5,10)}{\pgfxy(4,0)}{\pgfxy(0,1)}
%vertex on the crater
\pgfcircle[fill]{\pgfxy(1,10)}{0.05cm}
\pgfcircle[fill]{\pgfxy(9,10)}{0.05cm}
\pgfcircle[fill]{\pgfxy(5,9)}{0.05cm}
%edges from 0 to 1
\pgfline{\pgfxy(1,10)}{\pgfxy(0.5,8)}
\pgfline{\pgfxy(1,10)}{\pgfxy(1.5,8)}
\pgfline{\pgfxy(9,10)}{\pgfxy(8.5,8)}
\pgfline{\pgfxy(9,10)}{\pgfxy(9.5,8)}
\pgfline{\pgfxy(5,9)}{\pgfxy(5.5,7)}
\pgfline{\pgfxy(5,9)}{\pgfxy(4.5,7)}
%vertex on level 1
\pgfcircle[fill]{\pgfxy(0.5,8)}{0.05cm}
\pgfcircle[fill]{\pgfxy(1.5,8)}{0.05cm}
\pgfcircle[fill]{\pgfxy(8.5,8)}{0.05cm}
\pgfcircle[fill]{\pgfxy(9.5,8)}{0.05cm}
\pgfcircle[fill]{\pgfxy(4.5,7)}{0.05cm}
\pgfcircle[fill]{\pgfxy(5.5,7)}{0.05cm}
% edges left sheets
\pgfxyline(0,4)(0.5,2)
\pgfxyline(0,4)(0,2)
\pgfxyline(0,4)(-0.5,2)
\pgfxyline(2,4)(1.5,2)
\pgfxyline(2,4)(2,2)
\pgfxyline(2,4)(2.5,2)
% edges central sheets
\pgfxyline(4,4)(3.5,2)
\pgfxyline(4,4)(4,2)
\pgfxyline(4,4)(4.5,2)
\pgfxyline(6,4)(5.5,2)
\pgfxyline(6,4)(6,2)
\pgfxyline(6,4)(6.5,2)
% edges right sheets
\pgfxyline(8,4)(8.5,2)
\pgfxyline(8,4)(8,2)
\pgfxyline(8,4)(7.5,2)
\pgfxyline(10,4)(9.5,2)
\pgfxyline(10,4)(10,2)
\pgfxyline(10,4)(10.5,2)
% from now, dashed edges
\pgfsetdash{{0.1cm}{0.1cm}}{0.05cm}
% middle left dashed edges
\pgfxyline(0.5,8)(-0.5,6)
\pgfxyline(0.5,8)(0,4)
\pgfxyline(0.5,8)(0.95,6)
\pgfxyline(1.5,8)(1.05,6)
\pgfxyline(1.5,8)(2,4)
\pgfxyline(1.5,8)(2.5,6)
% middle center dashed edges
\pgfxyline(4.5,7)(3.5,5)
\pgfxyline(4.5,7)(4,4)
\pgfxyline(4.5,7)(4.95,5)
\pgfxyline(5.5,7)(5.05,5)
\pgfxyline(5.5,7)(6,4)
\pgfxyline(5.5,7)(6.5,5)
% middle right dashed edges
\pgfxyline(8.5,8)(7.5,6)
\pgfxyline(8.5,8)(8,4)
\pgfxyline(8.5,8)(8.95,6)
\pgfxyline(9.5,8)(9.05,6)
\pgfxyline(9.5,8)(10,4)
\pgfxyline(9.5,8)(10.5,6)
% vertex to the sheets
\pgfcircle[fill]{\pgfxy(0,4)}{0.05cm}
\pgfcircle[fill]{\pgfxy(2,4)}{0.05cm}
\pgfcircle[fill]{\pgfxy(4,4)}{0.05cm}
\pgfcircle[fill]{\pgfxy(6,4)}{0.05cm}
\pgfcircle[fill]{\pgfxy(8,4)}{0.05cm}
\pgfcircle[fill]{\pgfxy(10,4)}{0.05cm}
% sheet vertex left
\pgfcircle[fill]{\pgfxy(0.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(0,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(-0.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(1.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(2,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(2.5,2)}{0.05cm}
% sheet vertex center
\pgfcircle[fill]{\pgfxy(3.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(4,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(4.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(5.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(6,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(6.5,2)}{0.05cm}
% sheet vertex right
\pgfcircle[fill]{\pgfxy(8.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(8,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(7.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(9.5,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(10,2)}{0.05cm}
\pgfcircle[fill]{\pgfxy(10.5,2)}{0.05cm}
\end{pgfpicture}
\caption{A regular $\ell$-volcano, with $\ell=3$}
\label{fig:RegularVolcano}
\end{center}
\end{figure}

\fixme{Is true the number of edges per node in figure \ref{fig:RegularVolcano}?}

\fixme{define ``serralada'' (volcanoes range or system): as the joint of graphs of isogenies with many primer degrees.}

Different isogeny degrees recreates different volcanoes, and a set of volcanoes can be also represented in a graph like a mountain system. A composed isogeny degree describes this type of system of volcanoes of the factors of this composed degree.

\todo{define isogeny stars: as a particular case of volcanoes with only crater. But can we use a volcano as a star? (Perhaps if the crater is big enough?)}

\fixme{endomorphism ring}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{How the isogenies can help to avoid curve sharing? \label{sec:alg_isog}}

To avoid to share a curve between all the users of the standard of the \emph{rfc 6637} \cite{rfc6637} using elliptic curve isogenies, it is not necessary to build completely the volcano or the volcanoes system. With a definition of a path to \emph{walk} through the volcanoes system, and then \emph{forget} the path (to avoid a cryptoanalyst to mode any attack calculation), will be enough \emph{if and only if}, the path is large enough.

\todo{given an elliptic curve, generate an isogeny path through the volcanoes system, follow the path, forget it.}

The isogenies has been already proposed to solve a problem in cryptology, in \cite{Rostovtsev06public} a new cryptosystem is proposed who uses the isogenies for Diffie-Hellman key agreement \cite{Diffie76newdirections} and ElGamal public key \cite{ElGamal85pkdlp}. In this paper, the proposal of the authors is to use a route in an isogenies star as a secret key, and the public key is the destination of this route from a public well known elliptic curve. The fundamental of this cryptosystem is the strength of the problem to find a path between two curves, but is easy to go from one to another if you know the path.

The problem is alive, there are bibliography \cite{SubExpIso} to work in the direction of speed up the route walk in a volcanoes range (or in stars). 

\todo{computational data about isogeny path evaluations}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Front and side channel attacks to this schemas \label{sec:cryptanalysis}}

The most important thing in cryptology, specially when an schema is proposed, is to think on how an adversary can try to break it. The question is what of the known things of the schema gives any advantage to this adversary and measure statistically the impact of the hypothetical advantage. In this proposed example of use elliptic curve isogenies to allow the users of this cryptography to avoid sharing the same elliptic curve but saving the security of use a cryptographically good elliptic curve, the mathematical cryptanalysis is by try to take an advantage on the task to discover the walked path in the isogeny star.

\todo{cryptanalysis on this matter: Given two curves isogenies between them, find a path}\cite{FastBetweenIso}

Also there are other possible ways to break a cryptosystem that, further than attack directly the mathematics below, it tries to get the advantage from take a creative point of view over the application of the schema and that is called the side channel attacks.

\todo{possible side channel attacks (attacking the isogeny and to prevent attacks like `\emph{Zero-Value Points}' (ZVP))}

\todo{computational data about compute isogeny between to elliptic curves}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion \label{sec:conclusion}}
\todo{what about the simulated times to generate curves in mathematical software? are they inside a usable range?}

\todo{cryptanalysis of this creations}

\todo{close with a remember of the security risk cited in the X9-62}

\todo{remember the good skills of the elliptic curves over smart cards and the possibility of the reset of the cryptosystem setup}

%%%%%

\fixme{where must be said this? other usages of curve change}
%\cite{Akishita03zero-valuepoint}

\bibliographystyle{ieeetr}
\bibliography{../bibtex/sblanch.bib,../bibtex/standards.bib,../bibtex/ecc.bib,../bibtex/isogeny.bib,../bibtex/books.bib,../bibtex/crypto.bib,../bibtex/rfc.bib}


%% Further work of this article:
% smart cards
% reset capabilities
% front and side channel attacks to this schemas, countermeasures
% how this can be standardised

\end{document}
